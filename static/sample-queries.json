[
    {
        "description": "database schema",
        "sql_code": [
            "SELECT a.table_name, a.column_name as name, d.column_type as type, a.comment as description",
            "FROM duckdb_columns() a join (describe aws) d on d.column_name = a.column_name",
            "where a.table_name ilike 'aws'"
        ],
        "r_code": ""
    },
    {
        "description": "cores per dollar",
        "sql_code": [
            "SELECT release_year, arch,",
            "    max(cores/price_hour) cores_per_usd,",
            "    arg_max(instance, cores/price_hour) best_instance",
            "FROM aws",
            "GROUP BY release_year, arch",
            "ORDER BY cores_per_usd DESC"
        ],
        "r_code": [
            "to_svg <- svgstring(width = output.width.inch, height = output.height.inch, scaling = 1)",
            "theme_set(theme_bw())",
            "",
            "### the current table is bound to the variable 'df'",
            "output <- ggplot(df, aes(x = release_year, y = cores_per_usd, colour = arch)) +",
            "    geom_text(aes(label = best_instance)) +",
            "    theme(legend.position = 'bottom')",
            "## output to the html page",
            "plot(output); dev.off(); to_svg()"
        ]
    },
    {
        "description": "highest net bandwidth per dollar",
        "sql_code": [
            "select family, round(max(net_gbitps/price_hour), 2) net_gbitps_per_dollar",
            "from aws",
            "group by family",
            "order by net_gbitps_per_dollar desc"
        ],
        "r_code": ""
    }
]